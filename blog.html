<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Raffael Kaas - Homepage</title>

  <meta name="description" content="Raffael Kaas – Homepage">
  <meta name="author" content="Raffael Kaas">
  <link rel="canonical" href="https://rkaas.de/">
  <link rel="icon" type="image/png" href="favicon.png">

  <meta property="og:title" content="Raffael Kaas – Homepage">
  <meta property="og:description" content="About Me | Projects | Blog">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://rkaas.de/">
  <meta property="og:image" content="https://rkaas.de/assets/img/me.png">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Raffael Kaas">
  <meta name="twitter:description" content="About Me | Projects | Blog">
  <meta name="twitter:image" content="https://rkaas.de/assets/img/me.png">

  <!-- Styles -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
  <link rel="stylesheet" type="text/css" href="css/style.css">

  <!-- Structured Data: Person -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Person",
    "name": "Raffael Kaas",
    "jobTitle": "Software Engineer",
    "url": "https://rkaas.de/",
    "image": "https://rkaas.de/assets/img/me.png",
    "sameAs": [
      "https://www.linkedin.com/in/raffael-kaas-4b0869152",
      "https://github.com/raffael-kaas7"
    ],
    "knowsAbout": ["Embedded Systems", "ROS", "Linux", "C++", "Python", "ADAS", "Automotive"]
  }
  </script>
</head>
<body>
  <!-- Invisible H1 -->
  <h1 class="sr-only">Raffael Kaas – Software Engineer</h1>

  <nav class="navbar navbar-inverse navbar-fixed-top">
    <div class="container">
      <div class="navbar-left">
        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar"
          aria-expanded="false" aria-controls="navbar">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
      </div>
      <div class="navbar-right theme-switch-wrapper" style="padding-left: 1em">
        <label class="theme-switch" for="checkbox">
          <input type="checkbox" id="checkbox" />
          <div class="slider round"></div>
        </label>
      </div>
      <div id="navbar" class="collapse navbar-collapse navbar-left">
        <ul class="nav navbar-nav" style="font-weight: 400;">
          <li><a class="custom-link" href="/#top">Home</a></li>
          <li><a class="custom-link" href="/#about">About Me</a></li>
          <li><a class="custom-link" href="/#blog">Blog</a></li>
          <li><a class="custom-link" href="https://www.linkedin.com/in/raffael-kaas-4b0869152" target="_blank" rel="me noopener">LinkedIn</a></li>
          <li>
            <a class="custom-link" href="https://github.com/raffael-kaas7" target="_blank" rel="me noopener">
              <img src="assets/img/github.svg" alt="GitHub profile of Raffael Kaas" />
            </a>
          </li>
        </ul>
      </div>
    </div>
  </nav>

  
  <!-- <div class="hero">
    <div class="hero-inner">
      <p class="logo-icon"><img src="assets/img/me.png" alt="Raffael Kaas" style="border-radius: 50%;"></p>
      <p class="logo-tagline">Raffael Kaas</p>
    </div>
  </div> -->

  <a name="blog" style="background-color: var(--bg-color-alternate);"></a>
  <section>
    <div class="container"></div>
  </section>

  <section style="background-color: var(--heading-color); padding: 1.5em 0; text-align: center; color: white;">
    <!-- <a class="custom-link" href="mailto://mail@rkaas.de" style="font-weight: 400; font-size: 13pt;">
      <img src="assets/img/envelope.svg" alt="Envelope" style="margin-top: 2px; margin-right: 2px;" />
      mail@rkaas.com
    </a> -->
    <p>Copyright © 2025 Raffael Kaas. All rights reserved.</p>
  </section>

  <script>
    const toggleSwitch = document.querySelector('.theme-switch input[type="checkbox"]');
  
    // Function to switch themes
    function switchTheme(e) {
      if (e.target.checked) {
        document.documentElement.setAttribute('data-theme', 'dark');
        localStorage.setItem('theme', 'dark'); // Save theme to localStorage
      } else {
        document.documentElement.setAttribute('data-theme', 'light');
        localStorage.setItem('theme', 'light'); // Save theme to localStorage
      }
    }
  
    // Load the saved theme on page load
    const currentTheme = localStorage.getItem('theme') || 'light'; // Default to 'light' if no theme is saved
    document.documentElement.setAttribute('data-theme', currentTheme);
  
    // Update the toggle switch state based on the saved theme
    if (currentTheme === 'dark') {
      toggleSwitch.checked = true;
    } else {
      toggleSwitch.checked = false;
    }
  
    toggleSwitch.addEventListener('change', switchTheme, false);
  </script>

  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

  <script src="https://code.jquery.com/jquery-2.2.4.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
  <script async defer src="https://buttons.github.io/buttons.js"></script>

  <script>
    function removeHash() {
      history.pushState("", document.title, window.location.pathname
        + window.location.search);
    };
    $(window).bind('hashchange', function (event) {
      var hash = location.hash.replace('#', '');
      if (hash == 'top')
        removeHash();
    });

    $(function () {
      var navCollapse = $(".navbar-collapse");
      var navBrand = $(".navbar-brand");
      navBrand.on("click", null, function () {
        navCollapse.collapse('hide');
      });
      navCollapse.on("click", "a:not([data-toggle])", null, function () {
        navCollapse.collapse('hide');
      });
    });
  </script>

  <script>
    // Minimal front matter (YAML-like) parser for simple key: value pairs and arrays
    function parseFrontMatter(text) {
      const fmRegex = /^---\n([\s\S]*?)\n---\n?/;
      const match = text.match(fmRegex);
      if (!match) return { fm: null, body: text };
      const yaml = match[1];
      const fm = {};
      yaml.split(/\r?\n/).forEach(line => {
        if (!line.trim() || line.trim().startsWith('#')) return;
        const idx = line.indexOf(':');
        if (idx === -1) return;
        const key = line.slice(0, idx).trim();
        let val = line.slice(idx + 1).trim();
        // Remove surrounding quotes
        if ((val.startsWith('"') && val.endsWith('"')) || (val.startsWith("'") && val.endsWith("'"))) {
          val = val.slice(1, -1);
        }
        // Arrays in [a, b] or ["a", "b"]
        if (val.startsWith('[') && val.endsWith(']')) {
          try { val = JSON.parse(val.replace(/(['\"])?([a-zA-Z0-9_\-\s\/\.\:\,\&\(\)]+)(\1)?/g, (m)=>m)); } catch (e) {
            // Fallback: split by comma
            val = val.slice(1, -1).split(',').map(s => s.trim().replace(/^['\"]|['\"]$/g, ''));
          }
        } else if (val === 'true' || val === 'false') {
          val = (val === 'true');
        } else if (/^\d{4}-\d{2}-\d{2}$/.test(val)) {
          // keep date as string
        } else if (!isNaN(val) && val !== '') {
          val = Number(val);
        }
        fm[key] = val;
      });
      const body = text.replace(fmRegex, '');
      return { fm, body };
    }

    function setOrCreateMeta(name, content, attr = 'name') {
      if (!content) return;
      let el = document.head.querySelector(`meta[${attr}="${name}"]`);
      if (!el) {
        el = document.createElement('meta');
        el.setAttribute(attr, name);
        document.head.appendChild(el);
      }
      el.setAttribute('content', content);
    }

    function setOrCreateLink(rel, href) {
      if (!href) return;
      let el = document.head.querySelector(`link[rel="${rel}"]`);
      if (!el) {
        el = document.createElement('link');
        el.setAttribute('rel', rel);
        document.head.appendChild(el);
      }
      el.setAttribute('href', href);
    }

    function absoluteUrl(pathOrUrl) {
      if (!pathOrUrl) return null;
      try {
        return new URL(pathOrUrl, window.location.origin).toString();
      } catch(e) { return pathOrUrl; }
    }

    async function loadBlogPost() {
      const blogContainer = document.querySelector('a[name="blog"] + section .container');
      const blogDir = '/assets/blog/';
  
      // Get the query parameter from the URL
      const urlParams = new URLSearchParams(window.location.search);
      const post = urlParams.get('post');
  
      if (!post) {
        blogContainer.innerHTML = '<p>No blog post specified.</p>';
        return;
      }
  
      try {
        // Fetch the Markdown content of the specified post (try .md, fallback .html)
        let markdown = null;
        let response = await fetch(`${blogDir}${post}.md`, { cache: 'no-store' });
        if (!response.ok) {
          // Fallback: maybe Pages processed front matter into HTML: /assets/blog/post.html
            response = await fetch(`${blogDir}${post}.html`, { cache: 'no-store' });
        }
        if (!response.ok) {
          console.error('Fetch failed for both .md and .html', response.status, response.statusText);
          throw new Error('Blog post not found');
        }
        markdown = await response.text();
        const { fm, body } = parseFrontMatter(markdown);
  
        // Convert Markdown to HTML using marked.js
        //console.log("typeof marked", typeof marked); // Debugging: Check if marked is loaded
        const html = marked.parse(body); 
  
        // Display the blog post
        const postDiv = document.createElement('div');
        postDiv.classList.add('blog-post');
        // If front matter defines a title, render it as H1 for accessibility
        if (fm && fm.title) {
          const h1 = document.createElement('h1');
          h1.textContent = fm.title;
          postDiv.appendChild(h1);
          // Meta line (date • reading time)
          const meta = document.createElement('p');
          meta.className = 'post-meta';
          const parts = [];
          if (fm.date) {
            try {
              const dt = new Date(fm.date);
              parts.push(dt.toLocaleDateString(undefined, { year: 'numeric', month: 'short', day: '2-digit' }));
            } catch(e) { parts.push(fm.date); }
          }
          if (fm.readingTime) {
            parts.push(`${fm.readingTime} min read`);
          }
          if (parts.length) {
            meta.textContent = parts.join(' • ');
            postDiv.appendChild(meta);
          }
        }
        postDiv.innerHTML += html;
        blogContainer.appendChild(postDiv);

        // Enhance single images: wrap standalone <img> (not inside known galleries) in a standardized figure
        const isGalleryParent = (el) => {
          if (!el) return false;
          return el.closest('.garmin-app, .image-carousel, .img-modal, .chart, .finisher-photo');
        };
        const imgs = postDiv.querySelectorAll('img');
        imgs.forEach(img => {
          if (isGalleryParent(img)) return; // skip galleries and custom widgets
          // If already inside a figure, skip
          if (img.closest('figure')) return;
          const figure = document.createElement('figure');
          figure.className = 'blog-figure';
          img.parentNode.insertBefore(figure, img);
          figure.appendChild(img);
          // Caption preference: use title attribute, else alt if reasonably descriptive
          const captionText = img.getAttribute('title') || img.getAttribute('alt');
          if (captionText && captionText.trim().length > 0) {
            const cap = document.createElement('figcaption');
            cap.textContent = captionText.trim();
            figure.appendChild(cap);
          }
        });

        // Inject dynamic meta tags and JSON-LD if FM present
        if (fm) {
          const title = fm.title ? `${fm.title} – Raffael Kaas` : document.title;
          if (fm.title) document.title = title;

          setOrCreateMeta('description', fm.description || '');
          setOrCreateMeta('author', fm.author || 'Raffael Kaas');

          // Canonical URL
          const canonical = fm.canonical || `${window.location.origin}${window.location.pathname}?post=${fm.slug || post}`;
          setOrCreateLink('canonical', canonical);

          // Open Graph
          setOrCreateMeta('og:title', fm.title || '', 'property');
          setOrCreateMeta('og:description', fm.description || '', 'property');
          setOrCreateMeta('og:type', 'article', 'property');
          setOrCreateMeta('og:url', canonical, 'property');
          const ogImgAbs = absoluteUrl(fm.ogImage || '/assets/img/me.png');
          setOrCreateMeta('og:image', ogImgAbs, 'property');

          // Twitter
          setOrCreateMeta('twitter:card', 'summary_large_image');
          setOrCreateMeta('twitter:title', fm.title || 'Raffael Kaas – Software Engineer');
          setOrCreateMeta('twitter:description', fm.description || '');
          setOrCreateMeta('twitter:image', ogImgAbs);

          // Article JSON-LD
          const jsonLd = {
            '@context': 'https://schema.org',
            '@type': 'Article',
            headline: fm.title || '',
            datePublished: fm.date || undefined,
            dateModified: fm.lastmod || fm.date || undefined,
            author: {
              '@type': 'Person',
              name: fm.author || 'Raffael Kaas'
            },
            image: ogImgAbs,
            mainEntityOfPage: canonical,
            keywords: Array.isArray(fm.keywords) ? fm.keywords.join(', ') : undefined
          };
          // Remove any existing Article JSON-LD we added earlier
          const oldLd = document.querySelector('script[data-dynamic-jsonld="article"]');
          if (oldLd) oldLd.remove();
          const ldScript = document.createElement('script');
          ldScript.type = 'application/ld+json';
          ldScript.setAttribute('data-dynamic-jsonld', 'article');
          ldScript.textContent = JSON.stringify(jsonLd, null, 2);
          document.head.appendChild(ldScript);
        }
      } catch (error) {
        console.error('Error loading blog post:', error);
        blogContainer.innerHTML = '<p>Failed to load the blog post. Please try again later.</p>';
      }
    }
  
    // Load the blog post on page load
    document.addEventListener('DOMContentLoaded', loadBlogPost);
  </script>

  <!-- image carousel: vibe coding experiment -->
  <script>
    const carouselImages = [
      '/assets/blog/img/asset-allocation.png',
      '/assets/blog/img/dividends-hidden.png',
      '/assets/blog/img/authentication-graphs-hidden.png',
      '/assets/blog/img/multiple-depots-hidden.png'
    ];
    let carouselIndex = 0;
    function showCarouselImage(idx) {
      const img = document.getElementById('carousel-img');
      if (img) {
        img.style.opacity = 0;
        setTimeout(() => {
          img.src = carouselImages[idx];
          img.style.opacity = 1;
        }, 150);
      }
    }
    function carouselPrev() {
      carouselIndex = (carouselIndex - 1 + carouselImages.length) % carouselImages.length;
      showCarouselImage(carouselIndex);
    }
    function carouselNext() {
      carouselIndex = (carouselIndex + 1) % carouselImages.length;
      showCarouselImage(carouselIndex);
    }
    function openModal() {
      const modal = document.getElementById('img-modal');
      const modalImg = document.getElementById('modal-img');
      modalImg.src = carouselImages[carouselIndex];
      modal.classList.add('active');
    }
    function closeModal(event) {
      if (event.target.id === 'img-modal') {
        document.getElementById('img-modal').classList.remove('active');
      }
    }
  </script>
</body>
</html>